# Microsoft Graph Configuration (you should already have these)
TENANT_ID=your-tenant-id
MSAL_CLIENT_ID=your-client-id
MSAL_CLIENT_SECRET=your-client-secret
MS_GRAPH_SCOPE=https://graph.microsoft.com/.default
DEFAULT_SITE_URL=https://yourtenant.sharepoint.com/sites/work
DEFAULT_LIBRARY=Documents/Cornerstone Jobs

# FastField Configuration
FASTFIELD_API_URL=https://api.fastfieldforms.com/services/v3/datatables/
FASTFIELD_API_KEY=08c75cee57ac40afbad2909ce48c68c4
FASTFIELD_TABLE_NAME=Cornerstone Active Projects
FASTFIELD_WEBHOOK_SECRET=change-me
FASTFIELD_DOWNLOAD_AUTH_HEADER=Authorization: Basic base64encoded
FASTFIELD_STAGING_SITE_URL=https://yourtenant.sharepoint.com/sites/InternalCompanyWebsite
FASTFIELD_STAGING_LIBRARY_PATH=Cornerstone/JOB WALKS
FASTFIELD_STAGING_WAIT_MS=180000
FASTFIELD_STAGING_INITIAL_DELAY_MS=60000
FASTFIELD_STAGING_WAIT_INTERVAL_MS=10000

# Optional: CORS and other settings
CORS_ORIGIN=*
PORT=3001

# USPS Address Validation (Addresses 3.0)
USPS_CLIENT_ID=your-usps-client-id
USPS_CLIENT_SECRET=your-usps-client-secret
# USPS_SCOPE=addresses.read
# USPS_API_BASE=https://api.usps.com
# USPS_TOKEN_URL=https://api.usps.com/oauth2/v3/token
# USPS_VALIDATE_URL=https://api.usps.com/addresses/v3/address
# USPS_REQUEST_LIMIT=60

# Planner Premium Sync (Business Central + Dataverse)
BC_TENANT_ID=
BC_ENVIRONMENT=
BC_COMPANY_ID=
BC_CLIENT_ID=
BC_CLIENT_SECRET=
BC_API_BASE=https://api.businesscentral.dynamics.com/v2.0
BC_API_PUBLISHER=cornerstone
BC_API_GROUP=plannerSync
BC_API_VERSION=v1.0
BC_PROJECT_CHANGES_ENTITY_SET=projectChanges

DATAVERSE_BASE_URL=https://yourorg.api.crm.dynamics.com
DATAVERSE_API_VERSION=v9.2
DATAVERSE_TENANT_ID=
DATAVERSE_CLIENT_ID=
DATAVERSE_CLIENT_SECRET=
DATAVERSE_RESOURCE_SCOPE=https://yourorg.api.crm.dynamics.com/.default
DATAVERSE_NOTIFICATION_URL=
DATAVERSE_WEBHOOK_SECRET=
DATAVERSE_AUTH_MODE=client_credentials
DATAVERSE_AUTH_CLIENT_ID=
DATAVERSE_AUTH_CLIENT_SECRET=  # leave empty for public client apps
DATAVERSE_AUTH_SCOPES=https://yourorg.api.crm.dynamics.com/user_impersonation offline_access
DATAVERSE_AUTH_REDIRECT_URI=
DATAVERSE_AUTH_STATE_SECRET=
DATAVERSE_AUTH_SUCCESS_REDIRECT=
DATAVERSE_TOKEN_ENCRYPTION_SECRET=
DATAVERSE_REFRESH_TOKEN_FILE=.dataverse-refresh-token.json
PREMIUM_PROJECT_WEB_BASE=
PREMIUM_PROJECT_URL_TEMPLATE=

# Dataverse mapping (override as needed)
DATAVERSE_PROJECT_ENTITY_SET=msdyn_projects
DATAVERSE_TASK_ENTITY_SET=msdyn_projecttasks
DATAVERSE_PROJECT_ID_FIELD=msdyn_projectid
DATAVERSE_TASK_ID_FIELD=msdyn_projecttaskid
DATAVERSE_PROJECT_TITLE_FIELD=msdyn_subject
DATAVERSE_TASK_TITLE_FIELD=msdyn_subject
DATAVERSE_TASK_PROJECT_LOOKUP_FIELD=msdyn_project
DATAVERSE_TASK_PROJECT_ID_FIELD=_msdyn_project_value
DATAVERSE_BC_PROJECT_NO_FIELD=
DATAVERSE_BC_TASK_NO_FIELD=
DATAVERSE_TASK_START_FIELD=msdyn_start
DATAVERSE_TASK_FINISH_FIELD=msdyn_finish
DATAVERSE_TASK_PERCENT_FIELD=msdyn_percentcomplete
DATAVERSE_TASK_DESCRIPTION_FIELD=
DATAVERSE_TASK_MODIFIED_FIELD=modifiedon
DATAVERSE_ALLOW_PROJECT_CREATE=false
DATAVERSE_ALLOW_TASK_CREATE=true
DATAVERSE_ALLOW_TASK_DELETE=false
DATAVERSE_PERCENT_SCALE=1
DATAVERSE_PERCENT_MIN=0
DATAVERSE_PERCENT_MAX=100
DATAVERSE_USE_SCHEDULE_API=true

# Sync behavior
SYNC_PREFER_BC=true
SYNC_BC_MODIFIED_GRACE_MS=2000
SYNC_LOCK_TIMEOUT_MINUTES=30
SYNC_MAX_PROJECTS_PER_RUN=0
PREMIUM_DELETE_BEHAVIOR=clearLink
PREMIUM_POLL_PAGE_SIZE=200
PREMIUM_POLL_MAX_PAGES=10
PREMIUM_PROJECT_SYNC_FILE=.premium-project-sync.json
DATAVERSE_DELTA_FILE=.dataverse-delta.json

# Cron auth (for premium poll + BC jobs)
CRON_SECRET=
